# WebView

ğŸŒ [English](README.en.md)

## ğŸš© ëª©ì°¨

* [ê°œìš”](#ê°œìš”)
* [ìŠ¤í™](#ìŠ¤í™)
* [í”Œë«í¼ë³„ ì„¤ì •](#-í”Œë«í¼ë³„-ì„¤ì •)
* [API](#-api)
* [Release notes](./ReleaseNotes.md)


## ê°œìš”

ê²Œì„ì—ì„œ ë‹¤ì–‘í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì›¹ë·°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## ìŠ¤í™

### Unity ì§€ì› ë²„ì „

* 2018.4.0 ì´ìƒ

### Android ì§€ì› ë²„ì „

* 4.4 ì´ìƒ

### iOS ì§€ì›ë²„ì „

* 11 ì´ìƒ

### ì§€ì› í”Œë«í¼

* Android
* iOS 

### ì§€ì›í•˜ëŠ” ê¸°ëŠ¥

| Category | Spec |
| --- | --- |
| Style | Popup |
|   | Fullscreen |
| Navigation | Visibility |
|   | Color |
|   | Title |
|   | Back |
|   | Forward |
|   | Close |
| Show API | URL, HTML file, HTML string |
|   | Open Callback |
|   | Close Callback |
|   | Scheme Callback |
|   | Scheme List |
| Other | Execute JavaScript |
|   | Clear Cookies |
|   | Clear Cache |
|   | Multiple Windows |

## ğŸ”¨ í”Œë«í¼ë³„ ì„¤ì •

###  Android

[Gradle](https://docs.unity3d.com/Manual/android-gradle-overview.html)ì„ ì‚¬ìš©í•˜ì—¬ Androidì—ì„œ í•„ìš”í•œ ì¢…ì†ì„±ì„ ì„¤ì •í•©ë‹ˆë‹¤.
Unity 2019.3 ì´ì „ ë²„ì „ì˜ í”„ë¡œì íŠ¸ì—ì„œëŠ” **Internal** ë¹Œë“œ ì„¤ì •ì´ ì•„ë‹Œ **Gradle**ë¡œ ì „í™˜í•´ì•¼ í•©ë‹ˆë‹¤.

#### hardwareAccelerated ì„¤ì •

ì›í™œí•œ WebView ì‚¬ìš©ì„ ìœ„í•´ PostProcessBuild ìŠ¤í¬ë¦½íŠ¸ì—ì„œ **hardwareAccelerated**ë¥¼ í™œì„±í™”í•˜ê³  ìˆìŠµë‹ˆë‹¤.

#### Gradle ì„¤ì •

1.  **File > Build Settings > Player Settings > Android > Publishing Settings**ì—ì„œ **Custom Gradle Template**ì„ í™œì„±í™”í•˜ë©´ `Assets/Plugins/Android/mainTemplate.gradle` íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤.
    * ![unity_gradle.png](images/unity_gradle.png)
    * ì‚¬ìš© ì¤‘ì¸ mainTemplate.gradle íŒŒì¼ì´ ìˆì„ ë•ŒëŠ” ìƒëµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
2.  mainTemplate.gradleì˜ ì£¼ì„ ë¼ì¸ì„ ì œê±°í•©ë‹ˆë‹¤.
    ```gradle
    // GENERATED BY UNITY. REMOVE THIS COMMENT TO PREVENT OVERWRITING WHEN EXPORTING AGAIN
    ```
3.  mainTemplate.gradleì—ì„œ dependenciesë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
    ```gradle
    dependencies {
        implementation 'org.jetbrains.kotlin:kotlin-stdlib-jdk7:1.3.72'
    }
    ```
    * ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì—ì„œ ì´ë¯¸ ì¶”ê°€í•œ ê²½ìš° í•´ë‹¹ ê³¼ì •ì„ ì œì™¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### iOS

#### Other Linker Flags ì„¤ì •

Xcode Target(Unity-iPhone)ì—ì„œ **Build Settings > Linking > Other Linker Flags**ì— -ObjCë¥¼ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.

#### GPMWebView.bundle

Unity íŠ¹ì • ë²„ì „ì—ì„œ iOS ë¹Œë“œ ì‹œ, **ë‚´ë¹„ê²Œì´ì…˜ ë°”**ì˜ ë²„íŠ¼ì´ ë³´ì´ì§€ ì•ŠëŠ” í˜„ìƒì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
í•´ë‹¹ í˜„ìƒì´ ë°œìƒí•˜ë©´, Xcode Target(Unity-iPhone)ì˜ **Xcode Project > Build Phases > Copy Bundle Resource** ì„¤ì •ì—ì„œ + ë²„íŠ¼ì„ ëˆŒëŸ¬ `GPMWebView.bundle` íŒŒì¼ ê²€ìƒ‰í•˜ì—¬ ì¶”ê°€í•˜ì‹­ì‹œì˜¤.

![GPMWebViewBundle.png](images/GPMWebViewBundle.png)

## ğŸ”¨ API

### ShowUrl

WebViewë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

**Required íŒŒë¼ë¯¸í„°**

* url : íŒŒë¼ë¯¸í„°ë¡œ ì „ì†¡ë˜ëŠ” urlì€ ìœ íš¨í•œ ê°’ì´ì–´ì•¼ í•©ë‹ˆë‹¤.
* openCallback : WebViewê°€ ì˜¤í”ˆë  ë•Œ ì„±ê³µ ì—¬ë¶€ë¥¼ ì½œë°±ìœ¼ë¡œ ì•Œë ¤ì¤ë‹ˆë‹¤.

**Optional íŒŒë¼ë¯¸í„°**

* configuration : GpmWebViewRequest.Configurationìœ¼ë¡œ WebViewì˜ ì˜µì…˜ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* closeCallback : WebViewê°€ ì¢…ë£Œë  ë•Œ ì‚¬ìš©ìì—ê²Œ ì½œë°±ìœ¼ë¡œ ì•Œë ¤ì¤ë‹ˆë‹¤.
* schemeList : ì‚¬ìš©ìê°€ ë°›ê³  ì‹¶ì€ ì»¤ìŠ¤í…€ ìŠ¤í‚´(scheme) ëª©ë¡ì„ ì§€ì •í•©ë‹ˆë‹¤.
    * 'https://'ë¥¼ ì…ë ¥í•˜ë©´ 'https://'ë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  urlì„ schemeEventë¡œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    * schemeEventë¡œ ë°›ì€ schemeì€ redirect ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
* schemeEvent : schemeListë¡œ ì§€ì •í•œ ì»¤ìŠ¤í…€ Schemeì„ í¬í•¨í•˜ëŠ” urlì„ ì½œë°±ìœ¼ë¡œ ì•Œë ¤ ì¤ë‹ˆë‹¤.

#### Configuration

| Parameter | Values | Description |
| ------------------------- | ----------------------------------------- | -------------------------------- |
| style                     | GpmWebViewStyle.POPUP                     | íŒì—… ëª¨ë“œ |
|                           | GpmWebViewStyle.FULLSCREEN                | ì „ì²´ í™”ë©´ ëª¨ë“œ |
| isClearCookie             | bool                                      | ì¿ í‚¤ ì œê±° |
| isClearCache              | bool                                      | ìºì‹œ ì œê±° |
| isNavigationBarVisible    | bool                                      | ë„¤ë¹„ê²Œì´ì…˜ ë°” í™œì„± ë˜ëŠ” ë¹„í™œì„± |
| navigationBarColor        | string                                    | ë„¤ë¹„ê²Œì´ì…˜ ë°” ìƒ‰ìƒ |
| title                     | string                                    | WebViewì˜ ì œëª© |
| orientation               | UnityEngine.ScreenOrientation             | GPM WebView v1.1.0ì—ì„œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤. |
| isBackButtonVisible       | bool                                      | ë’¤ë¡œ ê°€ê¸° ë²„íŠ¼ í™œì„± ë˜ëŠ” ë¹„í™œì„±  |
| isForwardButtonVisible    | bool                                      | ì•ìœ¼ë¡œ ê°€ê¸° ë²„íŠ¼ í™œì„± ë˜ëŠ” ë¹„í™œì„± |
| contentMode</br>(iOS only)| GamebaseWebViewContentMode.RECOMMENDED    | í˜„ì¬ í”Œë«í¼ ì¶”ì²œ ë¸Œë¼ìš°ì € |
|                           | GamebaseWebViewContentMode.MOBILE         | ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € |
|                           | GamebaseWebViewContentMode.DESKTOP        | ë°ìŠ¤í¬íƒ‘ ë¸Œë¼ìš°ì € |
| supportMultipleWindows</br>(Android) only)    | bool                  | GPM WebViewì˜ ë‹¤ì¤‘ ì°½ ì§€ì› ì—¬ë¶€ |

**API**

```cs
public static void ShowUrl(
    string url,
    GpmWebViewRequest.Configuration configuration,
    GpmWebViewCallback.GpmWebViewErrorDelegate openCallback,
    GpmWebViewCallback.GpmWebViewErrorDelegate closeCallback,
    List<string> schemeList,
    GpmWebViewCallback.GpmWebViewDelegate<string> schemeEvent)
```

**Example**

```cs
public void ShowUrl()
{
    GpmWebView.ShowUrl(
        "http://gameplatform.toast.com/",
        new GpmWebViewRequest.Configuration()
        {
            style = GpmWebViewStyle.FULLSCREEN,
            isClearCookie = false,
            isClearCache = false,
            isNavigationBarVisible = true,
            navigationBarColor = "#4B96E6",
            title = "The page title.",
            isBackButtonVisible = true,
            isForwardButtonVisible = true,
#if UNITY_IOS
            contentMode = GpmWebViewContentMode.MOBILE
#elif UNITY_ANDROID
            supportMultipleWindows = true
#endif
        },
        OnOpenCallback,
        OnCloseCallback,
        new List<string>()
        {
            "USER_ CUSTOM_SCHEME"
        },
        OnSchemeEvent);
}

private void OnOpenCallback(GpmWebViewError error)
{
    if (error == null)
    {
        Debug.Log("[OnOpenCallback] succeeded.");
    }
    else
    {
        Debug.Log(string.Format("[OnOpenCallback] failed. error:{0}", error));
    }
}

private void OnCloseCallback(GpmWebViewError error)
{
    if (error == null)
    {
        Debug.Log("[OnCloseCallback] succeeded.");
    }
    else
    {
        Debug.Log(string.Format("[OnCloseCallback] failed. error:{0}", error));
    }
}

private void OnSchemeEvent(string data, GpmWebViewError error)
{
    if (error == null)
    {
        Debug.Log("[OnSchemeEvent] succeeded.");
        
        if (data.Equals("USER_ CUSTOM_SCHEME") == true || data.Contains("CUSTOM_SCHEME") == true)
        {
            Debug.Log(string.Format("scheme:{0}", data));
        }
    }
    else
    {
        Debug.Log(string.Format("[OnSchemeEvent] failed. error:{0}", error));
    }
}
```

### ShowHtmlFile

**Assets > StreamingAssets** í´ë”ì— ìˆëŠ” HTML íŒŒì¼ì„ ì›¹ë·°ì— ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.

![StreamingAssets.png](images/StreamingAssets.png)

ShowHtmlFile APIì˜ filePath ê°’ì€ ì•„ë˜ ì½”ë“œë¥¼ ì°¸ê³ í•˜ì—¬ ì…ë ¥í•˜ì‹­ì‹œì˜¤.

```cs
#if UNITY_IOS
    // "file://" + Application.streamingAssetsPath + "/" + "YOUR_HTML_PATH.html"
    string.Format("file://{0}/{1}", Application.streamingAssetsPath, "YOUR_HTML_PATH.html");
#elif UNITY_ANDROID
    // "file:///android_asset/" + "YOUR_HTML_PATH.html"
    string.Format("file:///android_asset/{0}", "YOUR_HTML_PATH.html");
#endif
```

**API**

```cs
public static void ShowHtmlFile(
    string filePath,
    GpmWebViewRequest.Configuration configuration,
    GpmWebViewCallback.GpmWebViewErrorDelegate openCallback,
    GpmWebViewCallback.GpmWebViewErrorDelegate closeCallback,
    List<string> schemeList,
    GpmWebViewCallback.GpmWebViewDelegate<string> schemeEvent)
```

**Example**

```cs
public void ShowHtmlFile()
{
    var htmlFilePath = string.Empty;
#if UNITY_IOS
        htmlFilePath = string.Format("file://{0}/{1}", Application.streamingAssetsPath, "YOUR_HTML_PATH.html");
#elif UNITY_ANDROID
        htmlFilePath = string.Format("file:///android_asset/{0}", "YOUR_HTML_PATH.html");
#endif

    GpmWebView.ShowHtmlFile(
        htmlFilePath,
        new GpmWebViewRequest.Configuration()
        {
            style = GpmWebViewStyle.FULLSCREEN,
            isClearCookie = false,
            isClearCache = false,
            isNavigationBarVisible = true,
            navigationBarColor = "#4B96E6",
            title = "The page title.",
            isBackButtonVisible = true,
            isForwardButtonVisible = true,
#if UNITY_IOS
            contentMode = GpmWebViewContentMode.MOBILE
#elif UNITY_ANDROID
            supportMultipleWindows = true
#endif
        },
        OnOpenCallback,
        OnCloseCallback,
        new List<string>()
        {
            "USER_ CUSTOM_SCHEME"
        },
        OnSchemeEvent);
}

private void OnOpenCallback(GpmWebViewError error)
{
    if (error == null)
    {
        Debug.Log("[OnOpenCallback] succeeded.");
    }
    else
    {
        Debug.Log(string.Format("[OnOpenCallback] failed. error:{0}", error));
    }
}

private void OnCloseCallback(GpmWebViewError error)
{
    if (error == null)
    {
        Debug.Log("[OnCloseCallback] succeeded.");
    }
    else
    {
        Debug.Log(string.Format("[OnCloseCallback] failed. error:{0}", error));
    }
}

private void OnSchemeEvent(string data, GpmWebViewError error)
{
    if (error == null)
    {
        Debug.Log("[OnSchemeEvent] succeeded.");
        
        if (data.Equals("USER_ CUSTOM_SCHEME") == true || data.Contains("CUSTOM_SCHEME") == true)
        {
            Debug.Log(string.Format("scheme:{0}", data));
        }
    }
    else
    {
        Debug.Log(string.Format("[OnSchemeEvent] failed. error:{0}", error));
    }
}
```

### ShowHtmlString

ì§€ì •ëœ HTML ë¬¸ìì—´ì„ ì›¹ë·°ì— ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.

**API**

```cs
public static void ShowHtmlString(
    string htmlString,
    GpmWebViewRequest.Configuration configuration,
    GpmWebViewCallback.GpmWebViewErrorDelegate openCallback,
    GpmWebViewCallback.GpmWebViewErrorDelegate closeCallback,
    List<string> schemeList,
    GpmWebViewCallback.GpmWebViewDelegate<string> schemeEvent)
```

**Example**

```cs
public void ShowHtmlString()
{
    GpmWebView.ShowHtmlString(
        "${HTML_STRING}",
        new GpmWebViewRequest.Configuration()
        {
            style = GpmWebViewStyle.FULLSCREEN,
            isClearCookie = false,
            isClearCache = false,
            isNavigationBarVisible = true,
            navigationBarColor = "#4B96E6",
            title = "The page title.",
            isBackButtonVisible = true,
            isForwardButtonVisible = true,
#if UNITY_IOS
            contentMode = GpmWebViewContentMode.MOBILE
#elif UNITY_ANDROID
            supportMultipleWindows = true
#endif
        },
        OnOpenCallback,
        OnCloseCallback,
        new List<string>()
        {
            "USER_ CUSTOM_SCHEME"
        },
        OnSchemeEvent);
}

private void OnOpenCallback(GpmWebViewError error)
{
    if (error == null)
    {
        Debug.Log("[OnOpenCallback] succeeded.");
    }
    else
    {
        Debug.Log(string.Format("[OnOpenCallback] failed. error:{0}", error));
    }
}

private void OnCloseCallback(GpmWebViewError error)
{
    if (error == null)
    {
        Debug.Log("[OnCloseCallback] succeeded.");
    }
    else
    {
        Debug.Log(string.Format("[OnCloseCallback] failed. error:{0}", error));
    }
}

private void OnSchemeEvent(string data, GpmWebViewError error)
{
    if (error == null)
    {
        Debug.Log("[OnSchemeEvent] succeeded.");
        
        if (data.Equals("USER_ CUSTOM_SCHEME") == true || data.Contains("CUSTOM_SCHEME") == true)
        {
            Debug.Log(string.Format("scheme:{0}", data));
        }
    }
    else
    {
        Debug.Log(string.Format("[OnSchemeEvent] failed. error:{0}", error));
    }
}
```

### ExecuteJavaScript

ì§€ì •ëœ JavaScript ë¬¸ìì—´ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.

**API**

```cs
public static void ExecuteJavaScript(string script)
```

**Example**

```cs
public void ExecuteJavaScriptSample()
{
    GpmWebView.ExecuteJavaScript("alert('ExecuteJavaScript');");
}
```

### Close

ë‹¤ìŒ APIë¥¼ ì´ìš©í•´ WebViewë¥¼ ë‹«ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**API**

```cs
public static void Close()
```

**Example**

```cs
public void Close()
{
    GpmWebView.Close();
}
```
